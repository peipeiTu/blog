"use strict";(self.webpackChunkgatsby_starter_blog=self.webpackChunkgatsby_starter_blog||[]).push([[733],{5131:function(a,e,n){n.r(e),n.d(e,{_frontmatter:function(){return o},default:function(){return p}});var s=n(3366),m=(n(7294),n(4983)),t=["components"],o={title:"MySQL配置及使用",date:"2019-12-09T06:09:03.000Z",description:"在使用MySQL过程中可能遇到的问题和解决方法",type:"数据库"},r={_frontmatter:o};function p(a){var e=a.components,n=(0,s.Z)(a,t);return(0,m.mdx)("wrapper",Object.assign({},r,n,{components:e,mdxType:"MDXLayout"}),(0,m.mdx)("h4",{id:"mysql设置允许外网访问",style:{position:"relative"}},(0,m.mdx)("a",{parentName:"h4",href:"#mysql%E8%AE%BE%E7%BD%AE%E5%85%81%E8%AE%B8%E5%A4%96%E7%BD%91%E8%AE%BF%E9%97%AE","aria-label":"mysql设置允许外网访问 permalink",className:"anchor before"},(0,m.mdx)("svg",{parentName:"a","aria-hidden":"true",focusable:"false",height:"16",version:"1.1",viewBox:"0 0 16 16",width:"16"},(0,m.mdx)("path",{parentName:"svg",fillRule:"evenodd",d:"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"}))),"MySQL设置允许外网访问"),(0,m.mdx)("p",null,"整个过程主要分为两部分：更新user表，更新mysql配置。"),(0,m.mdx)("h5",{id:"1-更新user表主要是新增一个用户供外网访问",style:{position:"relative"}},(0,m.mdx)("a",{parentName:"h5",href:"#1-%E6%9B%B4%E6%96%B0user%E8%A1%A8%E4%B8%BB%E8%A6%81%E6%98%AF%E6%96%B0%E5%A2%9E%E4%B8%80%E4%B8%AA%E7%94%A8%E6%88%B7%E4%BE%9B%E5%A4%96%E7%BD%91%E8%AE%BF%E9%97%AE","aria-label":"1 更新user表主要是新增一个用户供外网访问 permalink",className:"anchor before"},(0,m.mdx)("svg",{parentName:"a","aria-hidden":"true",focusable:"false",height:"16",version:"1.1",viewBox:"0 0 16 16",width:"16"},(0,m.mdx)("path",{parentName:"svg",fillRule:"evenodd",d:"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"}))),"1. 更新user表，主要是新增一个用户供外网访问。"),(0,m.mdx)("ul",null,(0,m.mdx)("li",{parentName:"ul"},"使用root登录数据库，查看user表是否存在供外网访问的user")),(0,m.mdx)("div",{className:"gatsby-highlight","data-language":"bash"},(0,m.mdx)("pre",{parentName:"div",className:"language-bash"},(0,m.mdx)("code",{parentName:"pre",className:"language-bash"},"mysql -uroot -p\n\n",(0,m.mdx)("span",{parentName:"code",className:"token comment"},"# 使用mysql库"),"\nmysql",(0,m.mdx)("span",{parentName:"code",className:"token operator"},">")," use mysql",(0,m.mdx)("span",{parentName:"code",className:"token punctuation"},";"),"\n\n",(0,m.mdx)("span",{parentName:"code",className:"token comment"},"# 查看当前已存在的用户"),"\nmysql",(0,m.mdx)("span",{parentName:"code",className:"token operator"},">")," SELECT ",(0,m.mdx)("span",{parentName:"code",className:"token variable"},(0,m.mdx)("span",{parentName:"span",className:"token variable"},"`"),(0,m.mdx)("span",{parentName:"span",className:"token function"},"host"),(0,m.mdx)("span",{parentName:"span",className:"token variable"},"`")),", ",(0,m.mdx)("span",{parentName:"code",className:"token variable"},(0,m.mdx)("span",{parentName:"span",className:"token variable"},"`"),"user",(0,m.mdx)("span",{parentName:"span",className:"token variable"},"`"))," FROM ",(0,m.mdx)("span",{parentName:"code",className:"token variable"},(0,m.mdx)("span",{parentName:"span",className:"token variable"},"`"),"user",(0,m.mdx)("span",{parentName:"span",className:"token variable"},"`")),(0,m.mdx)("span",{parentName:"code",className:"token punctuation"},";"),"\n+-----------+------------------+\n",(0,m.mdx)("span",{parentName:"code",className:"token operator"},"|")," ",(0,m.mdx)("span",{parentName:"code",className:"token function"},"host"),"      ",(0,m.mdx)("span",{parentName:"code",className:"token operator"},"|")," user             ",(0,m.mdx)("span",{parentName:"code",className:"token operator"},"|"),"\n+-----------+------------------+\n",(0,m.mdx)("span",{parentName:"code",className:"token operator"},"|")," %         ",(0,m.mdx)("span",{parentName:"code",className:"token operator"},"|")," root             ",(0,m.mdx)("span",{parentName:"code",className:"token operator"},"|"),"\n",(0,m.mdx)("span",{parentName:"code",className:"token operator"},"|")," localhost ",(0,m.mdx)("span",{parentName:"code",className:"token operator"},"|")," debian-sys-maint ",(0,m.mdx)("span",{parentName:"code",className:"token operator"},"|"),"\n",(0,m.mdx)("span",{parentName:"code",className:"token operator"},"|")," localhost ",(0,m.mdx)("span",{parentName:"code",className:"token operator"},"|")," mysql.session    ",(0,m.mdx)("span",{parentName:"code",className:"token operator"},"|"),"\n",(0,m.mdx)("span",{parentName:"code",className:"token operator"},"|")," localhost ",(0,m.mdx)("span",{parentName:"code",className:"token operator"},"|")," mysql.sys        ",(0,m.mdx)("span",{parentName:"code",className:"token operator"},"|"),"\n",(0,m.mdx)("span",{parentName:"code",className:"token operator"},"|")," localhost ",(0,m.mdx)("span",{parentName:"code",className:"token operator"},"|")," root             ",(0,m.mdx)("span",{parentName:"code",className:"token operator"},"|"),"\n+-----------+------------------+\n\n",(0,m.mdx)("span",{parentName:"code",className:"token comment"},"# 如果不存在host为%的用户，则新增用户，生产环境最好不要修改root为外网可访问"),"\nmysql",(0,m.mdx)("span",{parentName:"code",className:"token operator"},">")," UPDATE ",(0,m.mdx)("span",{parentName:"code",className:"token variable"},(0,m.mdx)("span",{parentName:"span",className:"token variable"},"`"),"user",(0,m.mdx)("span",{parentName:"span",className:"token variable"},"`"))," ",(0,m.mdx)("span",{parentName:"code",className:"token builtin class-name"},"set")," ",(0,m.mdx)("span",{parentName:"code",className:"token variable"},(0,m.mdx)("span",{parentName:"span",className:"token variable"},"`"),(0,m.mdx)("span",{parentName:"span",className:"token function"},"host"),(0,m.mdx)("span",{parentName:"span",className:"token variable"},"`"))," ",(0,m.mdx)("span",{parentName:"code",className:"token operator"},"=")," ",(0,m.mdx)("span",{parentName:"code",className:"token string"},"'%'")," WHERE ",(0,m.mdx)("span",{parentName:"code",className:"token variable"},(0,m.mdx)("span",{parentName:"span",className:"token variable"},"`"),"user",(0,m.mdx)("span",{parentName:"span",className:"token variable"},"`"))," ",(0,m.mdx)("span",{parentName:"code",className:"token operator"},"=")," ",(0,m.mdx)("span",{parentName:"code",className:"token string"},"'root'")," AND ",(0,m.mdx)("span",{parentName:"code",className:"token variable"},(0,m.mdx)("span",{parentName:"span",className:"token variable"},"`"),(0,m.mdx)("span",{parentName:"span",className:"token function"},"host"),(0,m.mdx)("span",{parentName:"span",className:"token variable"},"`"))," ",(0,m.mdx)("span",{parentName:"code",className:"token operator"},"=")," ",(0,m.mdx)("span",{parentName:"code",className:"token string"},"'localhost'"),(0,m.mdx)("span",{parentName:"code",className:"token punctuation"},";"),"\n\n",(0,m.mdx)("span",{parentName:"code",className:"token comment"},"# 更改权限"),"\nmysql",(0,m.mdx)("span",{parentName:"code",className:"token operator"},">")," GRANT ALL PRIVILEGES ON *.* TO ",(0,m.mdx)("span",{parentName:"code",className:"token string"},"'root'"),"@",(0,m.mdx)("span",{parentName:"code",className:"token string"},"'%'"),"  IDENTIFIED BY ",(0,m.mdx)("span",{parentName:"code",className:"token string"},"'123456'"),"  WITH GRANT OPTION",(0,m.mdx)("span",{parentName:"code",className:"token punctuation"},";"),"\n\n",(0,m.mdx)("span",{parentName:"code",className:"token comment"},"# 刷新权限"),"\nmysql",(0,m.mdx)("span",{parentName:"code",className:"token operator"},">")," FLUSH PRIVILEGES",(0,m.mdx)("span",{parentName:"code",className:"token punctuation"},";")))),(0,m.mdx)("h5",{id:"2-更新mysql配置",style:{position:"relative"}},(0,m.mdx)("a",{parentName:"h5",href:"#2-%E6%9B%B4%E6%96%B0mysql%E9%85%8D%E7%BD%AE","aria-label":"2 更新mysql配置 permalink",className:"anchor before"},(0,m.mdx)("svg",{parentName:"a","aria-hidden":"true",focusable:"false",height:"16",version:"1.1",viewBox:"0 0 16 16",width:"16"},(0,m.mdx)("path",{parentName:"svg",fillRule:"evenodd",d:"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"}))),"2. 更新mysql配置"),(0,m.mdx)("p",null,"在mysql默认配置中，设置了仅绑定127.0.0.1的地址，所以需要将此行注释掉，或修改成0.0.0.0"),(0,m.mdx)("div",{className:"gatsby-highlight","data-language":"bash"},(0,m.mdx)("pre",{parentName:"div",className:"language-bash"},(0,m.mdx)("code",{parentName:"pre",className:"language-bash"},(0,m.mdx)("span",{parentName:"code",className:"token function"},"sudo")," ",(0,m.mdx)("span",{parentName:"code",className:"token function"},"vi")," /etc/mysql/mysql.conf.d/mysqld.cnf\n\n",(0,m.mdx)("span",{parentName:"code",className:"token comment"},"# 注释掉下方设置"),"\n",(0,m.mdx)("span",{parentName:"code",className:"token comment"},"# bind-address = 127.0.0.1"),"\n\n",(0,m.mdx)("span",{parentName:"code",className:"token comment"},"# 重启服务"),"\n",(0,m.mdx)("span",{parentName:"code",className:"token function"},"sudo")," ",(0,m.mdx)("span",{parentName:"code",className:"token function"},"service")," mysql restart"))))}p.isMDXComponent=!0},3366:function(a,e,n){function s(a,e){if(null==a)return{};var n,s,m={},t=Object.keys(a);for(s=0;s<t.length;s++)n=t[s],e.indexOf(n)>=0||(m[n]=a[n]);return m}n.d(e,{Z:function(){return s}})}}]);
//# sourceMappingURL=component---src-pages-notebook-database-mysql-use-md-ebcc99de738c7e45d923.js.map